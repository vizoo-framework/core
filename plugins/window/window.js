!function(e){var t={};t.layout='<div data-vizoo-window-bg data-id="{data-id}" data-background="{background}"></div><div data-vizoo-window-box data-id="{data-id}" ><div data-vizoo-window-header data-id="{data-id}"></div><div data-vizoo-window-main data-id="{data-id}"></div><div data-vizoo-window-footer data-id="{data-id}"></div></div>',t.dependence={list:["essentials"],status:null},t.status={lastZindex:1e3},t.touchInit=function(a){e.plugins.essentials.move(a,{start:function(e){var a=e.getAttribute("data-id"),n=document.querySelector("[data-vizoo-window-wrapper]#"+a);t.status.lastZindex++,t.status.lastZindex++;var i=n.querySelector("[data-vizoo-window-bg]"),o=n.querySelector("[data-vizoo-window-box]");i.style["z-index"]=t.status.lastZindex,o.style["z-index"]=t.status.lastZindex+1}})},t.preMake=function(a){var n=a.type||null;if("info"==n){var i=a.title||"",o=a.description||"";a.addInput({container:"header",type:"label",value:i}).addInput({container:"main",type:"p",value:o}).addInput({container:"footer",type:"button",value:"ok"}).addInput({container:"footer",type:"button",value:"cancel",event:{click:function(e,t){t.close()}}}),t.make(a)}else if("clousure"==n){i=a.title||"";var d=a.url||"",r=a.close||!1;a.addInput({container:"main",type:"div",value:'<iframe src="'+d+'" style="border:0px;width:100%;height:100%">'}),""!=i&&a.addInput({container:"header",type:"label",value:i}),1==r&&a.addInput({container:"header",type:"span",value:"",class:"closeWindow",event:{click:function(e,t){t.close()}}}),t.make(a)}else if("import"==n){i=a.title||"",d=a.url||"",r=a.close||!1;e.ajax({url:d,success:function(e){a.addInput({container:"main",type:"div",value:e}),""!=i&&a.addInput({container:"header",type:"label",value:i}),1==r&&a.addInput({container:"header",type:"span",value:"",class:"closeWindow",event:{click:function(e,t){t.close()}}}),t.make(a)}})}},t.makeInputs=function(e){for(var t="",a="",n="",i="",o=0;o<e.length;o++){var d=e[o],r=d.id||null,u=d.container||null,l=d.type||null,c=d.value||"",s='class="'+d.class+'"'||"";"label"==l&&(t='<label data-id="'+r+'" '+s+"  >"+c+"</label>"),"p"==l&&(t='<p data-id="'+r+'" '+s+">"+c+"</p>"),"button"==l&&(t='<button data-id="'+r+'" '+s+">"+c+"</button>"),"div"==l&&(t='<div data-id="'+r+'" '+s+">"+c+"</div>"),"span"==l&&(t='<span data-id="'+r+'" '+s+">"+c+"</span>"),"header"==u?a+=t:"main"==u?n+=t:"footer"==u&&(i+=t)}return{header:a,main:n,footer:i}},t.make=function(e){var a=!0;0==e.wrapperTagForm&&(a=!1);var n=e.id||null,i=e.background||!1;if(1==a)var o=document.createElement("form");else o=document.createElement("div");if(null==n){n="vizoo_window_"+(new Date).getTime().toString(36)}if(void 0==document.querySelector("[data-vizoo-window-wrapper]#"+n)){var d=t.layout;d=(d=d.replace(/{data-id}/g,n)).replace(/{background}/g,i),o.setAttribute("data-vizoo-window-wrapper",""),o.id=n,o.name=n,o.attr=e,o.innerHTML=d;var r=e.container||null,u=document.querySelector('[data-vizoo-window-container][data-id="'+r+'"]');void 0!=u?u.appendChild(o):document.querySelector("body").appendChild(o)}else o=document.querySelector("[data-vizoo-window-wrapper]#"+n);t.status.lastZindex++,t.status.lastZindex++;var l=o.querySelector("[data-vizoo-window-bg]"),c=o.querySelector("[data-vizoo-window-box]");l.style["z-index"]=t.status.lastZindex,c.style["z-index"]=t.status.lastZindex+1,t.touchInit(o.querySelector("[data-vizoo-window-box]")),t.insertBar(o),e.id=o.id;var s=t.makeInputs(e.inputs);o.querySelector("[data-vizoo-window-header]").innerHTML=s.header,o.querySelector("[data-vizoo-window-main]").innerHTML=s.main,o.querySelector("[data-vizoo-window-footer]").innerHTML=s.footer,t.makeEvents(o,e.inputs),setTimeout(function(){t.show("#"+e.id)},10)},t.insertBar=function(e){var a=e.attr,n=a.container||null,i=a.title||"",o=a.id||"";if(null!=n){if(void 0!=document.querySelector('[data-id="windowbar_'+o+'"]'))return!1;var d=document.createElement("li");d.setAttribute("data-id","windowbar_"+o),d.innerHTML="<a>"+i+"</a>";var r=document.querySelector('[data-vizoo-window-bar][data-id="'+n+'"]');void 0==r.querySelector("ul")?r.innerHTML='<ul><li data-id="windowbar_'+o+'"><a>'+i+"</a></li></ul>":r.querySelector("ul").appendChild(d),document.querySelector('[data-id="windowbar_'+o+'"]').onclick=function(){var e=document.querySelector("[data-vizoo-window-wrapper]#"+o);t.status.lastZindex++,t.status.lastZindex++;var a=e.querySelector("[data-vizoo-window-bg]"),n=e.querySelector("[data-vizoo-window-box]");a.style["z-index"]=t.status.lastZindex,n.style["z-index"]=t.status.lastZindex+1}}},t.removeBar=function(e){e.attr.container;var t=e.attr.id,a=document.querySelector('[data-id="windowbar_'+t+'"]');a.parentNode.removeChild(a)},t.action=function(e){return{close:function(a){t.removeBar(e),null==a&&(a=e.id),t.hide("#"+a)}}},t.makeEvents=function(e,a){for(var n=0;n<a.length;n++){var i=a[n],o=i.event||null;if(null!==o)for(keyWindow in o){var d=i.id;document.querySelector('[data-id="'+d+'"]').element=e,document.querySelector('[data-id="'+d+'"]')["on"+keyWindow]=function(e){var a=this.element;console.log(keyWindow),o[keyWindow].call(this,e,t.action(a))}}}},t.show=function(a){var n=document.querySelector(a);n.setAttribute("data-status","active"),n.querySelector("[data-vizoo-window-box]").setAttribute("data-status","active"),e.addEvent(n,"click",function(e){null!=e.target.getAttribute("data-vizoo-window-wrapper")&&t.hide("#"+this.id)},!1)},t.hide=function(e){var t=document.querySelector(e);t.removeAttribute("data-status"),t.querySelector("[data-vizoo-window-box]").removeAttribute("data-status"),setTimeout(function(){},1e3)},t.remove=function(e){var t=document.querySelector(e);t.parentNode.removeChild(t)},t.defMethod=function(e){e.inputs=[],e.addInput=function(a){var n=t.generatorNumberUniquer();return e.inputs[e.inputs.length]=a,e.inputs[e.inputs.length-1].id=n,e}},t.generatorNumberUniquer=function(){return"_"+Math.random().toString(36).substr(2,9)},t.monitor=function(){for(var a=document.querySelectorAll("[data-vizoo-window]"),n=0;n<a.length;n++){var i=a[n];if(1!=i.windowInit){i.windowInit=1;var o=i.getAttribute("data-vizoo-window"),d=((o=e.string.stringToObject(o)).type,o.title,o.event||"");o.description;e.addEvent(i,d,function(e,a){t.defMethod(a),t.preMake(a)},null,o)}}setTimeout(function(){t.monitor()},1e3)},t.__construct=function(){t.monitor()},e.plugin.require(t.dependence.list,function(){t.dependence.dependence=!0,t.__construct()}),e.plugins.window=t}(vizoo);