/* Vizoo - 0.0.1 - vizoo.online -  Wallace Rio <wallrio@gmail.com> - wallrio.com */
!function(core){var self=function(id){this.id=id,this.loaded=!1,this.variables={};var parent=this;return this.var=function(key,value){if(void 0==key)return parent.variables;if("object"==typeof key){var obj=key;for(key2 in parent.variables=obj,obj)this.var[key2]=obj[key2]}else{var keyArray=key.split("/"),keyJoin="";for(key in keyArray)keyJoin+='["'+keyArray[key]+'"]',eval("if(parent.variables"+keyJoin+" === undefined || parent.variables"+keyJoin+" === null){parent.variables"+keyJoin+" = {};this.var"+keyJoin+" = {};}");if(void 0==value)return eval("var result = parent.variables"+keyJoin+" || null"),result;"object"==typeof value?(eval("parent.variables"+keyJoin+" = "+JSON.stringify(value)+";"),eval("parent.var"+keyJoin+" = "+JSON.stringify(value)+";")):(eval("parent.variables"+keyJoin+" = '"+value+"';"),eval("parent.var"+keyJoin+" = '"+value+"';"))}},this.storage=function(e,t){if(void 0==t)return localStorage.getItem(e);localStorage.setItem(e,t)},this.storageRemove=function(e){localStorage.removeItem(e)},this.container=function(e){var t=this;return this.container={},this.container.id=e,this.container.appid=parent.id,this.__construct=function(e){},this.container.resource=function(e,n){return void 0==n?parent.var("resource/"+t.container.id+"/"+e):(t.container.resource[e]=n,parent.var("resource/"+t.container.id+"/"+e,n),vizoo.document.replace("{resource::"+e+"}",n,null,t.container.id),this)},this.container.dom=function(e){return core.element(t.container.id+" "+e)},this.container.storage=function(e,t){return null!=t?(sessionStorage.setItem(e,t),!0):sessionStorage.getItem(e)},this.container.routeMonitor=function(){checkUrl=function(e,t){var n=String(e).split("/"),r=String(t).split("/"),i=(n[n.length-1],!1);for(key in r){if(r[key]!=n[key]&&"*"!==n[key]&&"*"!=e)return!1;i=!0}return i};vizoo.browser.observeUrl(function(e,t){var n=t.context,r=t.parent,i=t.callback,o=String(e.hash).substring(1);if(""==o&&(o="/"),void 0!=n.route.list)for(key in n.route.list){var a=n.route.list[key];if(a.hashCurrent=o,1==i(i,a,r))break}},{context:this,parent:t,callback:function(e,t,n){if(null==document.querySelector(n.container.id))return setTimeout(function(){e(e,t,n)}),!1;if("object"==typeof t.url){var r=null;for(key in t.url)if(!0===(r=checkUrl(t.url[key],t.hashCurrent)))break}else r=checkUrl(t.url,t.hashCurrent);if(!0===r){var i=function(e,t){return void 0==t&&(t=!0),null!=e&&(i.context=e,1==t&&(document.querySelector(n.container.id).innerHTML=i.context)),i.context};if(void 0!=t.files){var o=!1;for(keyFiles in t.files){var a=String(t.files[keyFiles]).split("/"),l=a[a.length-1].split("."),c=l[l.length-1],s=t.files[keyFiles];s=(s=s.replace("*","")).replace(/\/\//g,"/"),"js"==c?((u=document.createElement("script")).type="text/javascript",u.src=s,document.querySelector(n.container.id).appendChild(u)):"css"==c?((u=document.createElement("link")).rel="stylesheet",u.href=s,document.querySelector(n.container.id).appendChild(u)):"html"==c&&(o=!0,core.ajax({url:s,success:function(e){document.createElement("div"),document.querySelector(n.container.id).innerHTML,t.content?(i(e,!1),htmlContent=t.content(i,t.hashCurrent)):(htmlContent=e,document.querySelector(n.container.id).innerHTML=htmlContent)}}))}0==o&&(i(v,!1),htmlContent=t.content(i,t.hashCurrent))}else{var u=document.createElement("div"),v=document.querySelector(n.container.id).innerHTML;t.content?(i(v,!1),htmlContent=t.content(i,t.hashCurrent)):(htmlContent=v,document.querySelector(n.container.id).innerHTML=htmlContent)}return!0}return!1}})},this.container.route=function(e){if(e.id)var t=e.id;else t=core.string.generator().id;return void 0==this.route.list&&(this.route.list={}),void 0==this.route.listUrl&&(this.route.listUrl={}),void 0==this.list&&(this.list={}),void 0!=e&&(this.route.list[t]=e,this.list[t]=e,this.route.listUrl[e.url]=e),void 0==this.routeMonitorInit&&(this.routeMonitorInit=1,this.routeMonitor()),this},this.container.action=function(e,t){return this.action[e]=t,this},this.container.element=function(e,n){if("string"==typeof e){if(void 0==t.container.id)var r=document.querySelectorAll(e);else r=document.querySelectorAll(t.container.id+" "+e);for(var i=0;i<r.length;i++){1!=(o=r[i]).appContainerElementInit&&(o.appContainerElementInit=1,function(e,t){for(keyEvent in t.event)e.keyEvent=keyEvent,e["on"+keyEvent]=function(){var n=this.keyEvent;if(t.event[n])return t.event[n].call(e)}}(o,n))}}else if("object"==typeof e)for(key in e){if(void 0==t.container.id)r=document.querySelectorAll(e[key]);else r=document.querySelectorAll(t.container.id+" "+e[key]);for(i=0;i<r.length;i++){var o;1!=(o=r[i]).appContainerElementInit&&(o.appContainerElementInit=1,function(e,t){for(keyEvent in t.event)e["on"+keyEvent]=function(){if(t.event[keyEvent])return t.event[keyEvent].call(e)}}(o,n))}}return setTimeout(function(){t.container.element(e,n)},1),this},this.__construct(),this.container},this};core.plugins.app=self}(vizoo);