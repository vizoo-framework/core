/* Vizoo - v1.0.0 - http://vizoo.online - Wallace Rio <wallrio@gmail.com> */
/* Vizoo - v1.0.0 - http://vizoo.online - Wallace Rio <wallrio@gmail.com> */
/* Vizoo - v1.0.0 - http://vizoo.online - Wallace Rio <wallrio@gmail.com> */
/* Vizoo - v1.0.0 - http://vizoo.online - Wallace Rio <wallrio@gmail.com> */
!function(t){t.plugins.editor=function(e){var o=this;return o.textSelected=null,o.translate={en:{save:"Save",italic:"Italic",bold:"Bold",copy:"Copy"},"pt-br":{save:"Salvar",italic:"Italico",bold:"Negrito",copy:"Copiar"}},o.collectionButtons={viewer:{title:"Visual",attr:{action:"toogle"},event:{onmousemove:function(t,e){},onmousedown:function(t,e){if(1==t.status.forcemode)return!1;"visual"==t.status.mode?o.setEditor(""+t.id,"mode","html"):o.setEditor(""+t.id,"mode","visual")}}},save:{title:"Save",attr:{},event:{onmousedown:function(e,o){t.plugins.editor(e.id).content()}}},bold:{title:"Bold",attr:{},event:{onmousedown:function(t,e){var o=t.querySelector("[data-vizoo-editor-body]");t.querySelector("[data-vizoo-editor-bodyhtml]");if(1==(document.activeElement===o)){document.execCommand("bold",!1,null)}}}},italic:{title:"Italic",attr:{},event:{onmousedown:function(t,e){var o=t.querySelector("[data-vizoo-editor-body]");t.querySelector("[data-vizoo-editor-bodyhtml]");if(1==(document.activeElement===o)){document.execCommand("italic",!1,null)}}}},clipboard:{title:"Clipboard",attr:{},event:{onmousedown:function(t,e){var o=t.querySelector("[data-vizoo-editor-body]");t.querySelector("[data-vizoo-editor-bodyhtml]");if(1==(document.activeElement===o)){document.execCommand("italic",!1,null)}}}},search:{title:"Search",attr:{type:"text"},event:{onkeydown:function(e,o){t.plugins.editor(e.id).content()}}}},o.status=function(e){var n="visual",i=!1,a=!0,d=!1,r="en",l="default",u="icon-text",c=e.getAttribute("data-vizoo-editor-buttons"),s=e.getAttribute("data-vizoo-editor-buttons-status"),v=e.getAttribute("data-vizoo-editor-attr");null!=v&&(null!=(v=t.string.stringToObject(v)).mode&&(n=v.mode),null!=v.editable&&(a=v.editable),null!=v.forcemode&&(d=v.forcemode),null!=v.language&&(r=v.language),null!=v.theme&&(l=v.theme),null!=v.buttonsmode&&(u=v.buttonsmode),null!=v.inline&&(i=v.inline)),e.status={mode:n,editable:a,forcemode:d,buttons:c,buttonsstatus:s,language:r,buttonsmode:u,inline:i},o.setEditor(""+e.id,"mode",n),o.setEditor(""+e.id,"editable",a),o.setEditor(""+e.id,"inline",i),e.className=l},o.monitor=function(){for(var t=document.querySelectorAll("[data-vizoo-editor]"),e=0;e<t.length;e++){var n=t[e];1!=n.designEditorInit&&(n.designEditorInit=1,void 0!=n.id&&null!=n.id&&""!=n.id||(document.querySelector("#editor"+e)?n.id="editor"+(e+1):n.id="editor"+e),o.make(n),o.status(n),o.addButtons(n),o.status(n))}setTimeout(function(){o.monitor()},100)},o.insertTab=function(){if(!window.getSelection)return!1;var t=window.getSelection();if(!t.rangeCount)return!1;var e=t.getRangeAt(0);e.collapse(!0);var o=document.createElement("span");o.appendChild(document.createTextNode("\t")),o.style.whiteSpace="pre",e.insertNode(o),e.setStartAfter(o),e.collapse(!0),t.removeAllRanges(),t.addRange(e)},o.addButtons=function(t){var e=t.querySelector("[data-vizoo-editor-control]"),n=t.querySelector("[data-vizoo-editor-status]"),i="",a="",d=[],r=[];void 0!=t.status.buttons&&""!=t.status.buttons&&(d=t.status.buttons.split(",")),void 0!=t.status.buttonsstatus&&""!=t.status.buttonsstatus&&(r=t.status.buttonsstatus.split(","));var l=t.status.language;i+="<ul>",a+="<ul>";for(var u=0;u<d.length;u++){var c=d[u],s=o.translate[l][c]||null;if(o.collectionButtons[c]){var v=s||o.collectionButtons[c].title,m=o.collectionButtons[c].attr,b=t.status.buttonsmode||"icon-text",y="button",f="";if(null!=m.action)var g="data-vizoo-editor-button-toogle";else g="";"icon"==b&&(f="<span data-vizoo-editor-button-icon></span>"),"icon-text"==b&&(f="<span data-vizoo-editor-button-icon></span><span data-vizoo-editor-button-text >"+v+"</span>"),"text"==b&&(f="<span data-vizoo-editor-button-text >"+v+"</span>");var p='<a data-vizoo-editor-button data-name="'+c+'" data-type="'+y+'" '+g+" >"+f+"</a>";null!=m.type&&"text"==m.type&&(p='<input type="text" data-vizoo-editor-button data-name="'+c+'" data-type="'+(y="text")+'" '+g+' placeholder="'+v+'" >'),i+="<li>"+p+"</li>"}}for(u=0;u<r.length;u++){c=r[u],s=o.translate[l][c]||null;if(o.collectionButtons[c]){v=s||o.collectionButtons[c].title,y="button";if(null!=(m=o.collectionButtons[c].attr).action)g="data-vizoo-editor-button-toogle";else g="";p='<a data-vizoo-editor-button data-name="'+c+'" data-type="'+y+'" '+g+" >"+v+"</a>";null!=m.type&&"text"==m.type&&(p='<input type="text" data-vizoo-editor-button data-name="'+c+'" data-type="'+(y="text")+'" '+g+' placeholder="'+v+'" >'),a+="<li>"+p+"</li>"}}for(key in i+="</ul>",a+="</ul>",e.innerHTML=i,n.innerHTML=a,o.collectionButtons){var z=t.querySelectorAll('[data-vizoo-editor-button][data-name="'+key+'"],[data-vizoo-editor-button-status][data-name="'+key+'"]');for(u=0;u<z.length;u++){var h=z[u];null!=h&&(!function(e){var n=o.collectionButtons[e].attr,i=o.collectionButtons[e].event||null;for(keyEvent in i)!function(){var e=i[keyEvent];h[keyEvent]=function(o){"INPUT"!=this.tagName&&o.preventDefault(),null!=n.toogle&&("true"==this.getAttribute("data-vizoo-editor-button-toogle")?this.removeAttribute("data-vizoo-editor-button-toogle","false"):this.setAttribute("data-vizoo-editor-button-toogle","true")),null!=e&&e(t,this)}}(keyEvent)}(key),o.setCustomActions())}}d.length<1&&(e.style.display="none"),r.length<1&&(n.style.display="none")},o.setCustomActions=function(e){for(keyEditor in o.actionListCallback)for(keyButton in o.actionListCallback[keyEditor]){var n=o.actionListCallback[keyEditor][keyButton],i=document.querySelector("[data-vizoo-editor]#"+keyEditor),a=document.querySelector("[data-vizoo-editor]#"+keyEditor+' [data-vizoo-editor-button][data-name="'+keyButton+'"]');void 0!=a&&(a.onmousedown=function(){var e=t.plugins.editor(keyEditor).content();if(n)var o=n(e,i,this);return o})}},o.make=function(t){var e,o;e=t.textContent,o=t.innerHTML,t.innerHTML="",encodedStr=e.replace(/[\u00A0-\u9999<>\&]/gim,function(t){return"&#"+t.charCodeAt(0)+";"}),html="",html+="<div data-vizoo-editor-control ></div>",html+='<div data-vizoo-editor-body contentEditable="true" >',html+="</div>",html+='<div data-vizoo-editor-bodyhtml contentEditable="true" >',html+="</div>",html+="<div data-vizoo-editor-status ></div>",t.innerHTML=html,t.querySelector("[data-vizoo-editor-body]").innerHTML=o,t.querySelector("[data-vizoo-editor-bodyhtml]").textContent=o},o.content=function(t,o){var n=document.querySelector("[data-vizoo-editor]#"+e+" [data-vizoo-editor-body]"),i=document.querySelector("[data-vizoo-editor]#"+e+" [data-vizoo-editor-bodyhtml]");if(void 0!=t&&null!=t)return n.innerHTML=t,i.innerHTML=t,n.innerHTML;if(1==o){d=(d=(d=n.innerHTML).replace(/\<br\>/gim,"\n")).replace(/\<br ?\/\>/gim,"\n");var a=document.createElement("div");a.innerHTML=d,d=a.textContent}else{var d;d=(d=(d=(d=n.innerHTML).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/gm,"")).replace(/(\r\n|\n|\r)/gm,"")).replace(/ 	/gm," ")}return d},o.setEditor=function(t,e,n){var i=document.querySelector("[data-vizoo-editor]#"+t);"inline"==e?1==n&&i.setAttribute("data-vizoo-editor-inline",""):"editable"==e&&(i.querySelector("[data-vizoo-editor-body]").setAttribute("contenteditable",n),i.querySelector("[data-vizoo-editor-bodyhtml]").setAttribute("contenteditable",n));var a=i.querySelector("[data-vizoo-editor-body]"),d=i.querySelector("[data-vizoo-editor-bodyhtml]");if(a.onkeydown=function(t){9==t.keyCode&&(o.insertTab(),t.preventDefault())},"mode"==e){if(d.onkeyup=function(){a.innerHTML=this.textContent},a.onkeyup=function(t){d.innerHTML=this.textContent},"html"==n){i.status.mode="html",d.textContent=a.innerHTML,a.style.display="none",d.style.display="block";for(var r=i.querySelectorAll('[data-vizoo-editor-button][data-name="viewer"],[data-vizoo-editor-button-status][data-name="viewer"]'),l=0;l<r.length;l++){(u=r[l]).setAttribute("data-vizoo-editor-button-toogle","true"),u.innerHTML="HTML"}}else{i.status.mode="visual",a.innerHTML=d.textContent,a.style.display="block",d.style.display="none";for(r=i.querySelectorAll('[data-vizoo-editor-button][data-name="viewer"],[data-vizoo-editor-button-status][data-name="viewer"]'),l=0;l<r.length;l++){var u;(u=r[l]).innerHTML="Visual",u.removeAttribute("data-vizoo-editor-button-toogle")}}}},o.actionListCallback={},o.action=function(t,n){void 0==o.actionListCallback[e]&&(o.actionListCallback[e]={}),void 0==o.actionListCallback[e][t]&&(o.actionListCallback[e][t]=n),o.setCustomActions()},o.execCommandOnElement=function(t,e,o){if(void 0===o&&(o=null),void 0!==window.getSelection){for(var n=window.getSelection(),i=[],a=0,d=n.rangeCount;a<d;++a)i[a]=n.getRangeAt(a).cloneRange();document.designMode="on",n=window.getSelection(),document.createRange().selectNodeContents(t),document.execCommand(e,!1,o),document.designMode="off",(n=window.getSelection()).removeAllRanges();for(a=0,d=i.length;a<d;++a)n.addRange(i[a])}else if(void 0!==document.body.createTextRange){var r=document.body.createTextRange();r.moveToElementText(t),r.execCommand(e,!1,o)}},o.__construct=function(){o.monitor()},o},t.plugins.editor().__construct()}(vizoo);